jQuery(function(c){function a(d,f){var e=d.url;if(typeof d.sizes!="undefined"&&d.sizes[f]){e=d.sizes[f].url}return e}function b(d,f,h,g){var e="";if(f=="image"){e="<img src='"+a(d,h)+"'";e+=" alt='"+(typeof d.alt!="undefined"?d.alt:"")+"'";e+=" title='"+(typeof d.title!="undefined"?d.title:"")+"'";e+=" class='attachment-"+g+" size-"+g+"'>"}return e}c(".lws_adminpanel_btn_add_media").click(function(e){e.preventDefault();var g;var d=c(this);if(wp.media.frames.gk_frame){wp.media.frames.gk_frame.open();return}wp.media.frames.gk_frame=wp.media({title:d.data("title"),multiple:false,library:{type:d.data("type")},button:{text:d.data("pick")}});var f=function(){var i=wp.media.frames.gk_frame.state().get("selection");if(!i){return}var j=i.first();var h=d.closest(".lws_media_master");h.find(".lws-adm-media").html(b(j.attributes,d.data("type"),d.data("image-size"),d.data("class-size")));h.find(".lws_adminpanel_input_media_id").val(j.attributes.id);h.find(".lws_adminpanel_input_media_url").val(a(j.attributes,d.data("image-size")));h.find(".lws_adminpanel_btn_del_media").show()};wp.media.frames.gk_frame.on("select",f);wp.media.frames.gk_frame.open()});c(".lws_adminpanel_btn_del_media").click(function(e){e.preventDefault();var d=c(this).closest(".lws_media_master");d.find(".lws-adm-media").html("");d.find(".lws_adminpanel_input_media_id").val("");d.find(".lws_adminpanel_input_media_url").val("");c(this).hide()});c(".lws_adminpanel_input_media_url").change(function(){var f=c(this).val();var d=c(this).closest(".lws_media_master");if(f!=undefined&&f!=""){var e=d.find(".lws_adminpanel_btn_add_media");d.find(".lws-adm-media").html(b({url:f},e.data("type"),e.data("image-size"),e.data("class-size")));d.find(".lws_adminpanel_btn_del_media").show()}else{d.find(".lws_adminpanel_btn_del_media").trigger("click")}})});