jQuery(function(d){d(".lws-editlist-row").mouseover(function(){if(!d(this).closest("table.lws-editlist[uid]").find("tr.lws-editlist-line-form").is(":visible")){d(this).find(".lws-editlist-buttons").css("visibility","visible")}}).mouseout(function(){d(this).find(".lws-editlist-buttons").css("visibility","hidden")});function c(g){var i=g.closest("table.lws-editlist[uid]");i.find(".lws-editlist-row-editable").show();var f=g.parents(".lws-editlist-row-editable");try{var h=i.find("tr.lws-editlist-line-form");var k={};if(f.data("line").length>0){k=JSON.parse(lwsBase64.decode(f.data("line")))}h.lwsWriteForm(k,true);if(window.lwsInputchanged!==true){window.onbeforeunload=undefined}f.hide();h.prev().addBack().insertAfter(f);h.show();h.find("input, select, textarea").get(0).focus()}catch(j){}}d(".lws-editlist-btn-mod").click(function(){if(!d(this).closest("table.lws-editlist[uid]").find("tr.lws-editlist-line-form").is(":visible")){c(d(this))}return false});d(".lws-editlist-btn-dup").click(function(){var f=d(this).closest("table.lws-editlist[uid]");if(!f.find("tr.lws-editlist-line-form").is(":visible")){var e=d(this).parents(".lws-editlist-row-editable");var h=lwsBase64.toObj(e.data("line"));h[f.attr("uid")]="";var g=f.find("tr.lws-editlist-template[data-line]").clone(true);g.removeAttr("id");g.addClass("lws-editlist-row-editable").removeClass("lws-editlist-template");g.data("line",lwsBase64.fromObj(h));g.insertBefore(e);c(d(g.children()[0]))}return false});d(".lws-editlist-add[data-id]").click(function(){var e=d("#"+d(this).data("id"));if(!e.find("tr.lws-editlist-line-form").is(":visible")){var f=e.find("tr.lws-editlist-template[data-line]").clone(true);f.removeAttr("id");f.addClass("lws-editlist-row-editable").removeClass("lws-editlist-template");e.append(f);c(d(f.children()[0]))}return false});d("button.lws-editlist-btn-cancel").click(function(){var f=d(this).closest("table.lws-editlist[uid]");var e=f.find("tr.lws-editlist-line-form");var g=e.prev().prev();if(g.length>0&&g.attr("data-template")){g.remove()}f.find(".lws-editlist-row-editable").show();e.prev().addBack().hide();if(window.lwsInputchanged!==true){window.onbeforeunload=undefined}return false});d(".lws-editlist-btn-del").click(function(h){if(!d(this).closest("table.lws-editlist[uid]").find("tr.lws-editlist-line-form").is(":visible")){if(confirm(lws_adminpanel.confirmDel)){var f=d(this).parents(".lws-editlist-row-editable");if(f.length<=0){return false}var g={action:"lws_adminpanel_editlist",method:"del",id:f.parents("table").attr("id"),line:f.data("line")};d.getJSON(lws_ajax_url,g,function(e){if((0!=e)&&e.status){f.remove()}else{f.replaceWith("<p class='lws-error'>Erase error.</p>")}}).fail(function(i,j,e){f.replaceWith("<p class='lws-error'>Erase error, status: "+j+", error: "+e+"</p>")})}}return false});function b(e,f){e.find("td").each(function(g,i){if(i.hasAttribute("data-key")&&(f[d(i).data("key")]!=undefined)){var h=d(i).find(".lws-editlist-buttons");h.detach();d(i).html(f[d(i).data("key")]);if(h.length>0){d(i).append("<br/>",h)}d(i).trigger("change")}})}d("button.lws-editlist-btn-save").click(function(){var e=d(this).parents("tr").prev().prev();var g=d(this).closest("table.lws-editlist[uid]");var f=g.find("tr.lws-editlist-line-form");var i=f.lwsReadForm();var h={action:"lws_adminpanel_editlist",method:"put",id:e.parents("table").attr("id"),line:lwsBase64.fromObj(i)};d.getJSON(lws_ajax_url,h,function(j){if((0!=j)&&j.status&&(j.line!=undefined)){e.data("line",j.line);e.removeAttr("data-template");b(e,lwsBase64.toObj(j.line));g.find(".lws-editlist-row-editable").show();f.prev().addBack().hide();if(j.message!=undefined){alert(j.message)}if(window.lwsInputchanged!==true){window.onbeforeunload=undefined}}else{alert((0!=j)&&(j.error!=undefined)?j.error:lws_adminpanel.updateAlert)}}).fail(function(k,l,j){e.replaceWith("<p class='lws-error'>Upabte error, status: "+l+", error: "+j+"</p>").show()});return false});function a(h){d(document.body).css({cursor:"wait"});var e=d("input[name='tab']");var g=d("input[name='option_page']");var f=d("<form />").attr("method","get").attr("action","").appendTo("body");if(e.length>0){d("<input />").attr("name","tab").attr("value",e.val()).appendTo(f)}if(g.length>0){d("<input />").attr("name","page").attr("value",g.val()).appendTo(f)}f.append(h.clone());f.submit()}d("input[name='lws-editlist-selectall']").change(function(){var e=d(this).is(":checked");d(this).closest("table").find("input[name='lws-editlist-selectitem']").each(function(){d(this).prop("checked",e)});d(this).closest("table").find("input[name='lws-editlist-selectall']").each(function(){if(e!=d(this).is(":checked")){d(this).prop("checked",e)}})});d(".lws-editlist-action-trigger").click(function(i){d(document.body).css({cursor:"wait"});i.preventDefault();var h=d(this).closest(".lws-editlist-action");items=[];var f=d("#"+h.data("id")).find("input[name='lws-editlist-selectitem']").each(function(){if(d(this).is(":checked")&&d(this).data("id")!=undefined){items.push(lwsBase64.decode(d(this).data("id")))}});if(items.length<=0){d(document.body).css({cursor:"default"});alert(lws_adminpanel.noSelection)}else{var g=d("<form />").css("display","none").attr("method","post").attr("action",document.URL).appendTo("body");d("<input />").attr("name","action-items").attr("value",lwsBase64.fromObj(items)).appendTo(g);g.append(h.clone());g.submit()}});d("form").submit(function(e){var f=d(document.activeElement).closest(".lws-editlist-filters");if(f.length>0){e.preventDefault();a(f)}});d(".lws-input-enter-submit").keyup(function(f){if(f.which==10||f.which==13){d(this).closest("form").submit()}});d(".lws-paging-navspan-ok").click(function(){var e=d(this).data("name");d(this).closest(".lws-tablenav-pages").find("input[name='"+e+"']").val(d(this).data("page"));a(d(this).closest(".lws-editlist-filters"))});d(".lws-input-ipp").click(function(){var e=d(this).data("name");d(this).closest(".lws-perpage-input").find("input[name='"+e+"']").val(d(this).data("count"));a(d(this).closest(".lws-editlist-filters"))});d("table.lws-editlist[data-popup]").each(function(){var e=lwsBase64.decode(d(this).data("popup"));if(e.length>0){d("<div>").append(d("<p>").html(e)).appendTo(d("body")).dialog({modal:true,buttons:{Ok:function(){d(this).dialog("close")}}})}})});